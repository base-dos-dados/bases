/*

Query para publicar a tabela.

Esse é o lugar para:
    - modificar nomes, ordem e tipos de colunas
    - dar join com outras tabelas
    - criar colunas extras (e.g. logs, proporções, etc.)

Qualquer coluna definida aqui deve também existir em `table_config.yaml`.

# Além disso, sinta-se à vontade para alterar alguns nomes obscuros
# para algo um pouco mais explícito.

TIPOS:
    - Para modificar tipos de colunas, basta substituir STRING por outro tipo válido.
    - Exemplo: `SAFE_CAST(column_name AS NUMERIC) column_name`
    - Mais detalhes: https://cloud.google.com/bigquery/docs/reference/standard-sql/data-types

*/
CREATE VIEW basedosdados-dev.br_ibge_censo_demografico.microdados_pessoa_2010 AS
SELECT 
SAFE_CAST(sigla_uf AS STRING) sigla_uf,
SAFE_CAST(id_mesorregiao AS INT64) id_mesorregiao,
SAFE_CAST(id_microrregiao AS INT64) id_microrregiao,
SAFE_CAST(id_regiao_metropolitana AS INT64) id_regiao_metropolitana,
SAFE_CAST(id_municipio AS INT64) id_municipio,
SAFE_CAST(area_ponderacao AS INT64) area_ponderacao,
SAFE_CAST(situacao_setor AS INT64) situacao_setor,
SAFE_CAST(situacao_domicilio AS INT64) situacao_domicilio,
SAFE_CAST(controle AS INT64) controle,
SAFE_CAST(numero_ordem AS INT64) numero_ordem,
SAFE_CAST(peso_amostral AS FLOAT64) peso_amostral,
SAFE_CAST(v0502 AS INT64) v0502,
SAFE_CAST(v0601 AS INT64) v0601,
SAFE_CAST(v6033 AS INT64) v6033,
SAFE_CAST(v6036 AS INT64) v6036,
SAFE_CAST(v6037 AS INT64) v6037,
SAFE_CAST(v6040 AS INT64) v6040,
SAFE_CAST(v0606 AS INT64) v0606,
SAFE_CAST(v0613 AS INT64) v0613,
SAFE_CAST(v0614 AS INT64) v0614,
SAFE_CAST(v0615 AS INT64) v0615,
SAFE_CAST(v0616 AS INT64) v0616,
SAFE_CAST(v0617 AS INT64) v0617,
SAFE_CAST(v0618 AS INT64) v0618,
SAFE_CAST(v0619 AS INT64) v0619,
SAFE_CAST(v0620 AS INT64) v0620,
SAFE_CAST(v0621 AS INT64) v0621,
SAFE_CAST(v0622 AS INT64) v0622,
SAFE_CAST(v6222 AS INT64) v6222,
SAFE_CAST(v6224 AS INT64) v6224,
SAFE_CAST(v0623 AS INT64) v0623,
SAFE_CAST(v0624 AS INT64) v0624,
SAFE_CAST(v0625 AS INT64) v0625,
SAFE_CAST(v6252 AS INT64) v6252,
SAFE_CAST(v6254 AS INT64) v6254,
SAFE_CAST(v6256 AS INT64) v6256,
SAFE_CAST(v0626 AS INT64) v0626,
SAFE_CAST(v6262 AS INT64) v6262,
SAFE_CAST(v6264 AS INT64) v6264,
SAFE_CAST(v6266 AS INT64) v6266,
SAFE_CAST(v0627 AS INT64) v0627,
SAFE_CAST(v0628 AS INT64) v0628,
SAFE_CAST(v0629 AS INT64) v0629,
SAFE_CAST(v0630 AS INT64) v0630,
SAFE_CAST(v0631 AS INT64) v0631,
SAFE_CAST(v0632 AS INT64) v0632,
SAFE_CAST(v0633 AS INT64) v0633,
SAFE_CAST(v0634 AS INT64) v0634,
SAFE_CAST(v0635 AS INT64) v0635,
SAFE_CAST(v6400 AS INT64) v6400,
SAFE_CAST(v6352 AS INT64) v6352,
SAFE_CAST(v6354 AS INT64) v6354,
SAFE_CAST(v6356 AS INT64) v6356,
SAFE_CAST(v0636 AS INT64) v0636,
SAFE_CAST(v6362 AS INT64) v6362,
SAFE_CAST(v6364 AS INT64) v6364,
SAFE_CAST(v6366 AS INT64) v6366,
SAFE_CAST(v0637 AS INT64) v0637,
SAFE_CAST(v0638 AS INT64) v0638,
SAFE_CAST(v0639 AS INT64) v0639,
SAFE_CAST(v0640 AS INT64) v0640,
SAFE_CAST(v0641 AS INT64) v0641,
SAFE_CAST(v0642 AS INT64) v0642,
SAFE_CAST(v0643 AS INT64) v0643,
SAFE_CAST(v0644 AS INT64) v0644,
SAFE_CAST(v0645 AS INT64) v0645,
SAFE_CAST(v6461 AS INT64) v6461,
SAFE_CAST(v6471 AS INT64) v6471,
SAFE_CAST(v0648 AS INT64) v0648,
SAFE_CAST(v0649 AS INT64) v0649,
SAFE_CAST(v0650 AS INT64) v0650,
SAFE_CAST(v0651 AS INT64) v0651,
SAFE_CAST(v6511 AS INT64) v6511,
SAFE_CAST(v6513 AS INT64) v6513,
SAFE_CAST(v6514 AS FLOAT64) v6514,
SAFE_CAST(v0652 AS INT64) v0652,
SAFE_CAST(v6521 AS INT64) v6521,
SAFE_CAST(v6524 AS INT64) v6524,
SAFE_CAST(v6525 AS INT64) v6525,
SAFE_CAST(v6526 AS FLOAT64) v6526,
SAFE_CAST(v6527 AS INT64) v6527,
SAFE_CAST(v6528 AS FLOAT64) v6528,
SAFE_CAST(v6529 AS INT64) v6529,
SAFE_CAST(v6530 AS FLOAT64) v6530,
SAFE_CAST(v6531 AS INT64) v6531,
SAFE_CAST(v6532 AS FLOAT64) v6532,
SAFE_CAST(v0653 AS INT64) v0653,
SAFE_CAST(v0654 AS INT64) v0654,
SAFE_CAST(v0655 AS INT64) v0655,
SAFE_CAST(v0656 AS INT64) v0656,
SAFE_CAST(v0657 AS INT64) v0657,
SAFE_CAST(v0658 AS INT64) v0658,
SAFE_CAST(v0659 AS INT64) v0659,
SAFE_CAST(v6591 AS INT64) v6591,
SAFE_CAST(v0660 AS INT64) v0660,
SAFE_CAST(v6602 AS INT64) v6602,
SAFE_CAST(v6604 AS INT64) v6604,
SAFE_CAST(v6606 AS INT64) v6606,
SAFE_CAST(v0661 AS INT64) v0661,
SAFE_CAST(v0662 AS INT64) v0662,
SAFE_CAST(v0663 AS INT64) v0663,
SAFE_CAST(v6631 AS INT64) v6631,
SAFE_CAST(v6632 AS INT64) v6632,
SAFE_CAST(v6633 AS INT64) v6633,
SAFE_CAST(v0664 AS INT64) v0664,
SAFE_CAST(v6641 AS INT64) v6641,
SAFE_CAST(v6642 AS INT64) v6642,
SAFE_CAST(v6643 AS INT64) v6643,
SAFE_CAST(v0665 AS INT64) v0665,
SAFE_CAST(v6660 AS INT64) v6660,
SAFE_CAST(v6664 AS INT64) v6664,
SAFE_CAST(v0667 AS INT64) v0667,
SAFE_CAST(v0668 AS INT64) v0668,
SAFE_CAST(v6681 AS INT64) v6681,
SAFE_CAST(v6682 AS INT64) v6682,
SAFE_CAST(v0669 AS INT64) v0669,
SAFE_CAST(v6691 AS INT64) v6691,
SAFE_CAST(v6692 AS INT64) v6692,
SAFE_CAST(v6693 AS INT64) v6693,
SAFE_CAST(v6800 AS INT64) v6800,
SAFE_CAST(v0670 AS INT64) v0670,
SAFE_CAST(v0671 AS INT64) v0671,
SAFE_CAST(v6900 AS INT64) v6900,
SAFE_CAST(v6910 AS INT64) v6910,
SAFE_CAST(v6920 AS INT64) v6920,
SAFE_CAST(v6930 AS INT64) v6930,
SAFE_CAST(v6940 AS INT64) v6940,
SAFE_CAST(v6121 AS INT64) v6121,
SAFE_CAST(v0604 AS INT64) v0604,
SAFE_CAST(v0605 AS INT64) v0605,
SAFE_CAST(v5020 AS INT64) v5020,
SAFE_CAST(v5060 AS INT64) v5060,
SAFE_CAST(v5070 AS INT64) v5070,
SAFE_CAST(v5080 AS INT64) v5080,
SAFE_CAST(v6462 AS INT64) v6462,
SAFE_CAST(v6472 AS INT64) v6472,
SAFE_CAST(v5110 AS INT64) v5110,
SAFE_CAST(v5120 AS INT64) v5120,
SAFE_CAST(v5030 AS INT64) v5030,
SAFE_CAST(v5040 AS INT64) v5040,
SAFE_CAST(v5090 AS INT64) v5090,
SAFE_CAST(v5100 AS INT64) v5100,
SAFE_CAST(v5130 AS INT64) v5130
FROM basedosdados-dev.br_ibge_censo_demografico_staging.microdados_pessoa_2010 AS t
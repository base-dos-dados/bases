/*

Query para publicar a tabela.

Esse é o lugar para:
    - modificar nomes, ordem e tipos de colunas
    - dar join com outras tabelas
    - criar colunas extras (e.g. logs, proporções, etc.)

Qualquer coluna definida aqui deve também existir em `table_config.yaml`.

# Além disso, sinta-se à vontade para alterar alguns nomes obscuros
# para algo um pouco mais explícito.

TIPOS:
    - Para modificar tipos de colunas, basta substituir STRING por outro tipo válido.
    - Exemplo: `SAFE_CAST(column_name AS NUMERIC) column_name`
    - Mais detalhes: https://cloud.google.com/bigquery/docs/reference/standard-sql/data-types

*/
CREATE VIEW basedosdados-dev.br_ibge_censo_demografico.microdados_pessoa_2000 AS
SELECT 
SAFE_CAST(sigla_uf AS STRING) sigla_uf,
SAFE_CAST(id_mesorregiao AS INT64) id_mesorregiao,
SAFE_CAST(id_microrregiao AS INT64) id_microrregiao,
SAFE_CAST(id_regiao_metropolitana AS INT64) id_regiao_metropolitana,
SAFE_CAST(id_municipio AS INT64) id_municipio,
SAFE_CAST(id_distrito AS INT64) id_distrito,
SAFE_CAST(id_subdistrito AS INT64) id_subdistrito,
SAFE_CAST(controle AS INT64) controle,
SAFE_CAST(serie AS INT64) serie,
SAFE_CAST(area_ponderacao AS INT64) area_ponderacao,
SAFE_CAST(v1001 AS STRING) v1001,
SAFE_CAST(v1005 AS STRING) v1005,
SAFE_CAST(v1006 AS STRING) v1006,
SAFE_CAST(v1007 AS STRING) v1007,
SAFE_CAST(MARCA AS STRING) MARCA,
SAFE_CAST(v0401 AS STRING) v0401,
SAFE_CAST(v0402 AS STRING) v0402,
SAFE_CAST(v0403 AS STRING) v0403,
SAFE_CAST(v0404 AS STRING) v0404,
SAFE_CAST(v4752 AS STRING) v4752,
SAFE_CAST(v4754 AS STRING) v4754,
SAFE_CAST(v4070 AS STRING) v4070,
SAFE_CAST(v0408 AS STRING) v0408,
SAFE_CAST(v4090 AS STRING) v4090,
SAFE_CAST(v0410 AS STRING) v0410,
SAFE_CAST(v0411 AS STRING) v0411,
SAFE_CAST(v0412 AS STRING) v0412,
SAFE_CAST(v0413 AS STRING) v0413,
SAFE_CAST(v0414 AS STRING) v0414,
SAFE_CAST(v0415 AS STRING) v0415,
SAFE_CAST(v0416 AS STRING) v0416,
SAFE_CAST(v0417 AS STRING) v0417,
SAFE_CAST(v0418 AS STRING) v0418,
SAFE_CAST(v0419 AS STRING) v0419,
SAFE_CAST(v0420 AS STRING) v0420,
SAFE_CAST(v4210 AS STRING) v4210,
SAFE_CAST(v0422 AS STRING) v0422,
SAFE_CAST(v4230 AS STRING) v4230,
SAFE_CAST(v0424 AS STRING) v0424,
SAFE_CAST(v4250 AS STRING) v4250,
SAFE_CAST(v4260 AS STRING) v4260,
SAFE_CAST(v4276 AS STRING) v4276,
SAFE_CAST(v0428 AS STRING) v0428,
SAFE_CAST(v0429 AS STRING) v0429,
SAFE_CAST(v0430 AS STRING) v0430,
SAFE_CAST(v0431 AS STRING) v0431,
SAFE_CAST(v0432 AS STRING) v0432,
SAFE_CAST(v0433 AS STRING) v0433,
SAFE_CAST(v0434 AS STRING) v0434,
SAFE_CAST(v4355 AS STRING) v4355,
SAFE_CAST(v4300 AS STRING) v4300,
SAFE_CAST(v0436 AS STRING) v0436,
SAFE_CAST(v0437 AS STRING) v0437,
SAFE_CAST(v0438 AS STRING) v0438,
SAFE_CAST(v0439 AS STRING) v0439,
SAFE_CAST(v0440 AS STRING) v0440,
SAFE_CAST(v0441 AS STRING) v0441,
SAFE_CAST(v0442 AS STRING) v0442,
SAFE_CAST(v0443 AS STRING) v0443,
SAFE_CAST(v0444 AS STRING) v0444,
SAFE_CAST(v4452 AS STRING) v4452,
SAFE_CAST(v4462 AS STRING) v4462,
SAFE_CAST(v0447 AS STRING) v0447,
SAFE_CAST(v0448 AS STRING) v0448,
SAFE_CAST(v0449 AS STRING) v0449,
SAFE_CAST(v0450 AS STRING) v0450,
SAFE_CAST(v4511 AS STRING) v4511,
SAFE_CAST(v4512 AS STRING) v4512,
SAFE_CAST(v4513 AS STRING) v4513,
SAFE_CAST(v4514 AS FLOAT64) v4514,
SAFE_CAST(v4521 AS STRING) v4521,
SAFE_CAST(v4522 AS STRING) v4522,
SAFE_CAST(v4523 AS STRING) v4523,
SAFE_CAST(v4524 AS FLOAT64) v4524,
SAFE_CAST(v4525 AS STRING) v4525,
SAFE_CAST(v4526 AS FLOAT64) v4526,
SAFE_CAST(v0453 AS STRING) v0453,
SAFE_CAST(v0454 AS STRING) v0454,
SAFE_CAST(v4534 AS STRING) v4534,
SAFE_CAST(v0455 AS STRING) v0455,
SAFE_CAST(v0456 AS STRING) v0456,
SAFE_CAST(v4573 AS STRING) v4573,
SAFE_CAST(v4583 AS STRING) v4583,
SAFE_CAST(v4593 AS STRING) v4593,
SAFE_CAST(v4603 AS STRING) v4603,
SAFE_CAST(v4613 AS STRING) v4613,
SAFE_CAST(v4614 AS STRING) v4614,
SAFE_CAST(v4615 AS FLOAT64) v4615,
SAFE_CAST(v4620 AS STRING) v4620,
SAFE_CAST(v0463 AS STRING) v0463,
SAFE_CAST(v4654 AS STRING) v4654,
SAFE_CAST(v4670 AS STRING) v4670,
SAFE_CAST(v4690 AS STRING) v4690,
SAFE_CAST(P001 AS FLOAT64) P001,
SAFE_CAST(ESTR AS STRING) ESTR,
SAFE_CAST(ESTRP AS STRING) ESTRP,
SAFE_CAST(v4621 AS STRING) v4621,
SAFE_CAST(v4622 AS STRING) v4622,
SAFE_CAST(v4631 AS STRING) v4631,
SAFE_CAST(v4632 AS STRING) v4632,
SAFE_CAST(v0464 AS STRING) v0464,
SAFE_CAST(v4671 AS STRING) v4671,
SAFE_CAST(v4672 AS STRING) v4672,
SAFE_CAST(v4354 AS STRING) v4354,
SAFE_CAST(v4219 AS STRING) v4219,
SAFE_CAST(v4239 AS STRING) v4239,
SAFE_CAST(v4269 AS STRING) v4269,
SAFE_CAST(v4279 AS STRING) v4279,
SAFE_CAST(v4451 AS STRING) v4451,
SAFE_CAST(v4461 AS STRING) v4461
from basedosdados-dev.br_ibge_censo_demografico_staging.microdados_pessoa_2000 as t